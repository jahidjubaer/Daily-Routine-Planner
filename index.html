<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>জাহিদের দিনলিপি - ইন্টারেক্টিভ রুটিন</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Hind+Siliguri:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Chosen Palette: "Islamic Teal & Gold" -->
    <!-- Application Structure Plan: The application is designed as an interactive daily planner dashboard. Instead of a static weekly table, it defaults to the current day's schedule, presenting tasks as an interactive checklist. Users can easily navigate between days using prominent buttons. The core interaction is checking off tasks, which provides immediate visual feedback by updating progress charts (a donut chart for daily completion and a bar chart for weekly overview). This structure was chosen because it's more engaging, mobile-friendly, and focuses the user on 'today's' tasks, directly supporting their goal of daily review and motivation in a more dynamic way than a printable sheet. A "Smart Planning Assistant" feature powered by the Gemini API provides dynamic routine optimization suggestions. A "Detailed Plan" feature for each task, also powered by Gemini API, provides specific guidance and breakdown for individual tasks. A "Motivation/Inspiration" feature, powered by Gemini API, generates motivational quotes or Islamic reminders to keep the user focused and inspired. A "Daily Reflection Prompt" feature, also powered by Gemini API, generates prompts for self-reflection based on the user's routine and Islamic values, encouraging deeper introspection and personal growth. A new "Daily Islamic Knowledge" feature, powered by Gemini API, provides short pieces of Islamic knowledge, Hadith, or Ayats relevant to daily life. -->
    <!-- Visualization & Content Choices: 
        1. Report Info: Static weekly routine table -> Goal: Create an actionable daily checklist -> Viz/Presentation Method: Interactive list of task cards with checkboxes -> Interaction: Clicking a checkbox marks a task complete with a visual strikethrough -> Justification: Far more interactive and user-friendly than a static table, providing tangible feedback -> Library/Method: Vanilla JS DOM Manipulation.
        2. Report Info: The need to review progress -> Goal: Motivate user with visual feedback -> Viz/Presentation Method: Donut chart for daily progress, Bar chart for weekly summary -> Interaction: Charts update automatically when a task is checked -> Justification: Visual data is highly motivational and provides a clear, at-a-glance summary of accomplishments -> Library/Method: Chart.js.
        3. Report Info: Various task categories (religion, study, etc.) -> Goal: Show time distribution -> Viz/Presentation Method: A pie chart showing how time is allocated -> Interaction: Chart dynamically updates based on the selected day -> Justification: Helps user understand if their time allocation aligns with their priorities -> Library/Method: Chart.js.
        4. Report Info: Learning path for ML/DS/OOP -> Goal: Provide clear, static guidance -> Viz/Presentation Method: A well-formatted text section -> Interaction: None -> Justification: Presents the information in a clear, readable format -> Library/Method: HTML & Tailwind CSS.
        5. Report Info: User needs help with routine optimization -> Goal: Provide dynamic, AI-powered planning suggestions -> Viz/Presentation Method: Textual suggestions generated by LLM -> Interaction: "Smart Planning Assistant" button triggers LLM call and displays suggestions in a dedicated area -> Justification: Leverages AI to provide personalized and actionable advice, directly addressing the user's need for routine adjustment and motivation -> Library/Method: Gemini API (fetch call).
        6. Report Info: User needs guidance on specific tasks -> Goal: Provide detailed breakdown and tips for individual tasks -> Viz/Presentation Method: Textual guidance generated by LLM in a modal -> Interaction: "বিস্তারিত পরিকল্পনা ✨" button on each task card triggers LLM call and displays detailed plan in a modal -> Justification: Offers on-demand, context-specific assistance for task execution, enhancing productivity and learning -> Library/Method: Gemini API (fetch call) and Vanilla JS for modal.
        7. Report Info: User needs motivation and reminders -> Goal: Provide uplifting messages -> Viz/Presentation Method: Textual quote/reminder generated by LLM -> Interaction: "অনুপ্রেরণা ✨" button triggers LLM call and displays message in a dedicated area -> Justification: Directly addresses the need for motivation and spiritual reminders, enhancing user engagement and adherence to routine -> Library/Method: Gemini API (fetch call).
        8. Report Info: User wants to reflect on their day -> Goal: Provide prompts for daily reflection -> Viz/Presentation Method: Textual prompt generated by LLM -> Interaction: "দৈনিক আত্ম-পর্যালোচনা ✨" button triggers LLM call and displays prompt in a dedicated area -> Justification: Encourages self-assessment and spiritual growth, aligning with user's focus on religious practice and daily review -> Library/Method: Gemini API (fetch call).
        9. Report Info: User wants daily Islamic reminders/knowledge -> Goal: Provide short, relevant Islamic insights -> Viz/Presentation Method: Textual Islamic knowledge/Hadith/Ayat generated by LLM -> Interaction: "দৈনিক ইসলামিক জ্ঞান ✨" button triggers LLM call and displays content in a dedicated area -> Justification: Directly supports the user's primary focus on religious practice and continuous learning -> Library/Method: Gemini API (fetch call).
    -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body {
            font-family: 'Hind Siliguri', sans-serif;
            background-color: #f8f7f4; /* Warm Neutral Background */
        }
        .bg-primary { background-color: #008080; } /* Teal */
        .text-primary { color: #008080; }
        .bg-secondary { background-color: #e6c584; } /* Soft Gold */
        .text-secondary { color: #e6c584; }
        .bg-accent { background-color: #f4a261; }
        .border-primary { border-color: #008080; }
        .day-btn {
            transition: all 0.3s ease;
        }
        .day-btn.active {
            background-color: #008080; /* Teal */
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        .task-card {
            transition: all 0.3s ease;
            border-left-width: 4px;
        }
        .task-card.completed {
            background-color: #e8f3f3;
            opacity: 0.7;
        }
        .task-card.completed .task-text {
            text-decoration: line-through;
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 400px;
            margin-left: auto;
            margin-right: auto;
            height: 300px;
            max-height: 350px;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 350px;
            }
        }
        /* Modal Styles */
        .modal {
            display: none; /* Hidden by default */
            position: fixed; /* Stay in place */
            z-index: 1000; /* Sit on top */
            left: 0;
            top: 0;
            width: 100%; /* Full width */
            height: 100%; /* Full height */
            overflow: auto; /* Enable scroll if needed */
            background-color: rgba(0,0,0,0.4); /* Black w/ opacity */
            justify-content: center;
            align-items: center;
        }
        .modal-content {
            background-color: #fefefe;
            margin: auto;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            width: 90%;
            max-width: 600px;
            position: relative;
        }
        .close-button {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
        }
        .close-button:hover,
        .close-button:focus {
            color: black;
            text-decoration: none;
            cursor: pointer;
        }
    </style>
</head>
<body class="text-gray-800">

    <div class="container mx-auto p-4 md:p-8 max-w-7xl">
        <header class="text-center mb-8">
            <h1 class="text-4xl md:text-5xl font-bold text-primary">জাহিদের দিনলিপি</h1>
            <p class="mt-2 text-lg text-gray-600">আপনার দৈনন্দিন জীবনকে গুছিয়ে নিন</p>
            <p id="currentDate" class="mt-2 text-md text-gray-500"></p>
        </header>

        <main class="grid grid-cols-1 lg:grid-cols-3 gap-8">
            <div class="lg:col-span-2">
                <section id="daily-planner">
                    <h2 class="text-2xl font-bold text-primary mb-4">সাপ্তাহিক পরিকল্পনা</h2>
                    <div id="day-selector" class="grid grid-cols-3 sm:grid-cols-7 gap-2 mb-6">
                    </div>
                    
                    <div id="task-list-container" class="bg-white p-4 sm:p-6 rounded-lg shadow-lg min-h-[500px]">
                        <h3 id="selected-day-title" class="text-xl font-bold mb-4 border-b-2 pb-2 border-primary">আজকের কাজ</h3>
                        <div class="flex flex-wrap gap-2 mb-4">
                            <button id="smart-plan-btn" class="px-4 py-2 bg-primary text-white rounded-lg shadow hover:bg-teal-700 transition duration-300">
                                পরিকল্পনা সহায়ক ✨
                            </button>
                            <button id="motivation-btn" class="px-4 py-2 bg-secondary text-white rounded-lg shadow hover:bg-yellow-600 transition duration-300">
                                অনুপ্রেরণা ✨
                            </button>
                            <button id="reflection-btn" class="px-4 py-2 bg-accent text-white rounded-lg shadow hover:bg-orange-600 transition duration-300">
                                দৈনিক আত্ম-পর্যালোচনা ✨
                            </button>
                            <button id="islamic-knowledge-btn" class="px-4 py-2 bg-primary text-white rounded-lg shadow hover:bg-teal-700 transition duration-300">
                                দৈনিক ইসলামিক জ্ঞান ✨
                            </button>
                        </div>

                        <div id="llm-suggestion-area" class="mt-4 p-4 bg-blue-50 border border-blue-200 rounded-lg text-sm text-blue-800 hidden">
                            <p class="font-semibold mb-2">স্মার্ট পরিকল্পনা পরামর্শ:</p>
                            <div id="llm-suggestion-content"></div>
                            <div id="llm-loading-indicator" class="hidden text-center mt-2">
                                <div class="animate-spin rounded-full h-6 w-6 border-b-2 border-primary inline-block"></div>
                                <p>লোড হচ্ছে...</p>
                            </div>
                        </div>

                        <div id="motivation-area" class="mt-4 p-4 bg-green-50 border border-green-200 rounded-lg text-sm text-green-800 hidden">
                            <p class="font-semibold mb-2">অনুপ্রেরণা বার্তা:</p>
                            <div id="motivation-content"></div>
                            <div id="motivation-loading-indicator" class="hidden text-center mt-2">
                                <div class="animate-spin rounded-full h-6 w-6 border-b-2 border-primary inline-block"></div>
                                <p>লোড হচ্ছে...</p>
                            </div>
                        </div>

                        <div id="reflection-area" class="mt-4 p-4 bg-purple-50 border border-purple-200 rounded-lg text-sm text-purple-800 hidden">
                            <p class="font-semibold mb-2">আত্ম-পর্যালোচনার জন্য প্রশ্ন:</p>
                            <div id="reflection-content"></div>
                            <div id="reflection-loading-indicator" class="hidden text-center mt-2">
                                <div class="animate-spin rounded-full h-6 w-6 border-b-2 border-primary inline-block"></div>
                                <p>লোড হচ্ছে...</p>
                            </div>
                        </div>

                        <div id="islamic-knowledge-area" class="mt-4 p-4 bg-yellow-50 border border-yellow-200 rounded-lg text-sm text-yellow-800 hidden">
                            <p class="font-semibold mb-2">দৈনিক ইসলামিক জ্ঞান:</p>
                            <div id="islamic-knowledge-content"></div>
                            <div id="islamic-knowledge-loading-indicator" class="hidden text-center mt-2">
                                <div class="animate-spin rounded-full h-6 w-6 border-b-2 border-primary inline-block"></div>
                                <p>লোড হচ্ছে...</p>
                            </div>
                        </div>

                        <div id="task-list" class="space-y-4">
                        </div>
                    </div>
                </section>
            </div>

            <aside class="lg:col-span-1 space-y-8">
                <section id="progress-view" class="bg-white p-6 rounded-lg shadow-lg">
                    <h3 class="text-xl font-bold text-primary mb-4">দৈনিক অগ্রগতি</h3>
                    <div class="chart-container">
                        <canvas id="dailyProgressChart"></canvas>
                    </div>
                     <p id="daily-summary-text" class="text-center mt-4 text-gray-600"></p>
                </section>

                <section id="weekly-summary-view" class="bg-white p-6 rounded-lg shadow-lg">
                    <h3 class="text-xl font-bold text-primary mb-4">সাপ্তাহিক সারসংক্ষেপ</h3>
                     <div class="chart-container" style="height: 300px;">
                        <canvas id="weeklyProgressChart"></canvas>
                    </div>
                </section>

                <section id="time-allocation-view" class="bg-white p-6 rounded-lg shadow-lg">
                    <h3 class="text-xl font-bold text-primary mb-4">সময় বন্টন</h3>
                    <p class="text-sm text-gray-500 mb-4">আজকের দিনের কাজের ধরন অনুযায়ী সময় বন্টন দেখানো হলো।</p>
                     <div class="chart-container">
                        <canvas id="timeAllocationChart"></canvas>
                    </div>
                </section>
            </aside>
        </main>
        
        <footer class="mt-12 bg-white p-6 rounded-lg shadow-lg">
            <h2 class="text-2xl font-bold text-primary mb-4">ভবিষ্যৎ শেখার পথ</h2>
            <p class="mb-4 text-gray-600">ওয়েব ডেভেলপমেন্টের পাশাপাশি আপনার আগ্রহের বিষয়গুলো শেখার জন্য একটি পরিকল্পিত পথ নিচে দেওয়া হলো। ওয়েব ডেভেলপমেন্টের কাজ শেষ হলে বা ভার্সিটির চাপ কম থাকলে এই বিষয়গুলো চর্চা করতে পারেন।</p>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                <div class="p-4 bg-gray-50 rounded-lg border border-gray-200">
                    <h4 class="font-bold text-lg text-primary">১. ডাটা স্ট্রাকচার ও অ্যালগরিদম (DS & Algo)</h4>
                    <p class="text-sm mt-2">যেকোনো ভালো প্রোগ্রামার হওয়ার ভিত্তি। এটি সবার আগে জরুরি।</p>
                    <ul class="list-disc list-inside text-sm mt-2 space-y-1">
                        <li><strong>চর্চা:</strong> LeetCode, HackerRank-এ নিয়মিত প্রবলেম সলভিং।</li>
                    </ul>
                </div>
                <div class="p-4 bg-gray-50 rounded-lg border border-gray-200">
                    <h4 class="font-bold text-lg text-primary">২. অবজেক্ট ওরিয়েন্টেড প্রোগ্রামিং (OOP)</h4>
                    <p class="text-sm mt-2">আধুনিক সফটওয়্যার ডেভেলপমেন্টের জন্য অপরিহার্য।</p>
                     <ul class="list-disc list-inside text-sm mt-2 space-y-1">
                        <li><strong>ভাষা:</strong> Python বা Java দিয়ে ধারণাগুলো আয়ত্ত করা।</li>
                    </ul>
                </div>
                <div class="p-4 bg-gray-50 rounded-lg border border-gray-200">
                    <h4 class="font-bold text-lg text-primary">৩. প্রবলেম সলভিং (PS)</h4>
                    <p class="text-sm mt-2">DS & Algo শেখার পাশাপাশি নিয়মিত অনুশীলন চালিয়ে যেতে হবে।</p>
                    <ul class="list-disc list-inside text-sm mt-2 space-y-1">
                         <li><strong>লক্ষ্য:</strong> প্রতিদিন অন্তত ১-২টি নতুন প্রবলেম সমাধান করা।</li>
                    </ul>
                </div>
                <div class="p-4 bg-gray-50 rounded-lg border border-gray-200">
                    <h4 class="font-bold text-lg text-primary">৪. মেশিন লার্নিং (ML)</h4>
                    <p class="text-sm mt-2">অন্যান্য ভিত্তিগুলো মজবুত হওয়ার পর এটি শুরু করা শ্রেয়।</p>
                    <ul class="list-disc list-inside text-sm mt-2 space-y-1">
                         <li><strong>সম্পদ:</strong> Andrew Ng-এর Coursera কোর্স দিয়ে শুরু করতে পারেন।</li>
                    </ul>
                </div>
            </div>
        </footer>
    </div>

    <!-- The Modal -->
    <div id="detailedPlanModal" class="modal">
        <div class="modal-content">
            <span class="close-button">&times;</span>
            <h3 id="modal-title" class="text-xl font-bold text-primary mb-4">বিস্তারিত পরিকল্পনা</h3>
            <div id="modal-content-area" class="text-gray-700 text-sm"></div>
            <div id="modal-loading-indicator" class="hidden text-center mt-4">
                <div class="animate-spin rounded-full h-6 w-6 border-b-2 border-primary inline-block"></div>
                <p>লোড হচ্ছে...</p>
            </div>
        </div>
    </div>

    <script>
        const scheduleData = {
            "রবিবার": [
                { time: "৬:৪৫ PM", task: "মাগরিবের নামাজ ও আমল", duration: 30, category: "ধর্ম চর্চা", completed: false, icon: "🕌" },
                { time: "৭:৩০ PM", task: "টিউশনি (যাতায়াত সহ)", duration: 60, category: "কাজ", completed: false, icon: "🏫" },
                { time: "৮:৩০ PM", task: "পরবর্তী দিনের পরিকল্পনা", duration: 15, category: "পরিকল্পনা", completed: false, icon: "📝" },
                { time: "৮:১৫ PM", task: "এশার নামাজ ও আমল (সূরা মুলক পাঠ)", duration: 30, category: "ধর্ম চর্চা", completed: false, icon: "🕌" },
                { time: "৮:৪৫ PM", task: "ব্যক্তিগত চিন্তা লেখা / হালকা কাজ", duration: 75, category: "ব্যক্তিগত", completed: false, icon: "✍️" },
                { time: "১০:০০ PM", task: "ঘুমের প্রস্তুতি (ডিভাইস বন্ধ)", duration: 30, category: "স্বাস্থ্য", completed: false, icon: "📵" },
                { time: "১০:৩০ PM", task: "ঘুম", duration: 360, category: "ঘুম", completed: false, icon: "😴" },
                { time: "৪:৩০ AM", task: "বিছানা গোছানো, ফ্রেশ হওয়া, ওজু", duration: 15, category: "ব্যক্তিগত", completed: false, icon: "💧" },
                { time: "৪:৪৫ AM", task: "ফজরের নামাজ ও আমল", duration: 30, category: "ধর্ম চর্চা", completed: false, icon: "🕌" },
                { time: "৫:১৫ AM", task: "পানি পান, ডেস্ক পরিষ্কার", duration: 15, category: "ব্যক্তিগত", completed: false, icon: "✨" },
                { time: "৫:৩০ AM", task: "ডিপ ওয়ার্ক (ওয়েব ডেভেলপমেন্ট)", duration: 210, category: "ওয়েব ডেভেলপমেন্ট", completed: false, icon: "💻" },
                { time: "৯:০০ AM", task: "ডিপ ওয়ার্ক (ওয়েব ডেভেলপমেন্ট)", duration: 180, category: "ওয়েব ডেভেলপমেন্ট", completed: false, icon: "💻" },
                { time: "১২:০০ PM", task: "ঘর গোছানো, কাপড় ধোয়া", duration: 60, category: "ব্যক্তিগত", completed: false, icon: "🧹" },
                { time: "১:২৫ PM", task: "জোহরের নামাজ", duration: 20, category: "ধর্ম চর্চা", completed: false, icon: "🕌" },
                { time: "১:৪৫ PM", task: "দুপুরের খাবার ও বিশ্রাম", duration: 75, category: "স্বাস্থ্য", completed: false, icon: "🍽️" },
                { time: "৩:০০ PM", task: "ML/DS/Algo/OOP শেখা", duration: 120, category: "অন্যান্য পড়া", completed: false, icon: "🧠" },
                { time: "৫:১৫ PM", task: "আছরের নামাজ", duration: 15, category: "ধর্ম চর্চা", completed: false, icon: "🕌" },
                { time: "৫:৩০ PM", task: "হাঁটাচলা / খেলাধুলা", duration: 75, category: "স্বাস্থ্য", completed: false, icon: "🏃‍♂️" }
            ],
            "সোমবার": [
                { time: "৬:৪৫ PM", task: "মাগরিবের নামাজ ও আমল", duration: 30, category: "ধর্ম চর্চা", completed: false, icon: "🕌" },
                { time: "৭:৩০ PM", task: "বই পড়া / একাডেমিক পড়া", duration: 60, category: "একাডেমিক", completed: false, icon: "📚" },
                { time: "৮:৩০ PM", task: "পরবর্তী দিনের পরিকল্পনা", duration: 15, category: "পরিকল্পনা", completed: false, icon: "📝" },
                { time: "৮:১৫ PM", task: "এশার নামাজ ও আমল (সূরা মুলক পাঠ)", duration: 30, category: "ধর্ম চর্চা", completed: false, icon: "🕌" },
                { time: "৮:৪৫ PM", task: "ব্যক্তিগত চিন্তা লেখা / হালকা কাজ", duration: 75, category: "ব্যক্তিগত", completed: false, icon: "✍️" },
                { time: "১০:০০ PM", task: "ঘুমের প্রস্তুতি (ডিভাইস বন্ধ)", duration: 30, category: "স্বাস্থ্য", completed: false, icon: "📵" },
                { time: "১০:৩০ PM", task: "ঘুম", duration: 360, category: "ঘুম", completed: false, icon: "😴" },
                { time: "৪:৩০ AM", task: "বিছানা গোছানো, ফ্রেশ হওয়া, ওজু", duration: 15, category: "ব্যক্তিগত", completed: false, icon: "💧" },
                { time: "৪:৪৫ AM", task: "ফজরের নামাজ ও আমল", duration: 30, category: "ধর্ম চর্চা", completed: false, icon: "🕌" },
                { time: "৫:১৫ AM", task: "পানি পান, ডেস্ক পরিষ্কার", duration: 15, category: "ব্যক্তিগত", completed: false, icon: "✨" },
                { time: "৫:৩০ AM", task: "ডিপ ওয়ার্ক (ওয়েব ডেভেলপমেন্ট)", duration: 210, category: "ওয়েব ডেভেলপমেন্ট", completed: false, icon: "💻" },
                { time: "৯:০০ AM", task: "ভার্সিটি ক্লাস", duration: 180, category: "ভার্সিটি", completed: false, icon: "🎓" },
                { time: "১২:০০ PM", task: "ঘর গোছানো, কাপড় ধোয়া", duration: 60, category: "ব্যক্তিগত", completed: false, icon: "🧹" },
                { time: "১:২৫ PM", task: "জোহরের নামাজ", duration: 20, category: "ধর্ম চর্চা", completed: false, icon: "🕌" },
                { time: "১:৪৫ PM", task: "দুপুরের খাবার ও বিশ্রাম", duration: 75, category: "স্বাস্থ্য", completed: false, icon: "🍽️" },
                { time: "৩:০০ PM", task: "ওয়েব ডেভেলপমেন্ট (অসম্পূর্ণ কাজ)", duration: 120, category: "ওয়েব ডেভেলপমেন্ট", completed: false, icon: "💻" },
                { time: "৫:১৫ PM", task: "আছরের নামাজ", duration: 15, category: "ধর্ম চর্চা", completed: false, icon: "🕌" },
                { time: "৫:৩০ PM", task: "হাঁটাচলা / খেলাধুলা", duration: 75, category: "স্বাস্থ্য", completed: false, icon: "🏃‍♂️" }
            ],
            "মঙ্গলবার": [
                { time: "৬:৪৫ PM", task: "মাগরিবের নামাজ ও আমল", duration: 30, category: "ধর্ম চর্চা", completed: false, icon: "🕌" },
                { time: "৭:৩০ PM", task: "টিউশনি (যাতায়াত সহ)", duration: 60, category: "কাজ", completed: false, icon: "🏫" },
                { time: "৮:৩০ PM", task: "পরবর্তী দিনের পরিকল্পনা", duration: 15, category: "পরিকল্পনা", completed: false, icon: "📝" },
                { time: "৮:১৫ PM", task: "এশার নামাজ ও আমল (সূরা মুলক পাঠ)", duration: 30, category: "ধর্ম চর্চা", completed: false, icon: "🕌" },
                { time: "৮:৪৫ PM", task: "ব্যক্তিগত চিন্তা লেখা / হালকা কাজ", duration: 75, category: "ব্যক্তিগত", completed: false, icon: "✍️" },
                { time: "১০:০০ PM", task: "ঘুমের প্রস্তুতি (ডিভাইস বন্ধ)", duration: 30, category: "স্বাস্থ্য", completed: false, icon: "📵" },
                { time: "১০:৩০ PM", task: "ঘুম", duration: 360, category: "ঘুম", completed: false, icon: "😴" },
                { time: "৪:৩০ AM", task: "বিছানা গোছানো, ফ্রেশ হওয়া, ওজু", duration: 15, category: "ব্যক্তিগত", completed: false, icon: "💧" },
                { time: "৪:৪৫ AM", task: "ফজরের নামাজ ও আমল", duration: 30, category: "ধর্ম চর্চা", completed: false, icon: "🕌" },
                { time: "৫:১৫ AM", task: " পানি পান, ডেস্ক পরিষ্কার", duration: 15, category: "ব্যক্তিগত", completed: false, icon: "✨" },
                { time: "৫:৩০ AM", task: "ডিপ ওয়ার্ক (ওয়েব ডেভেলপমেন্ট)", duration: 210, category: "ওয়েব ডেভেলপমেন্ট", completed: false, icon: "💻" },
                { time: "৯:০০ AM", task: "ডিপ ওয়ার্ক (ওয়েব ডেভেলপমেন্ট)", duration: 180, category: "ওয়েব ডেভেলপমেন্ট", completed: false, icon: "💻" },
                { time: "১২:০০ PM", task: "ভার্সিটি ক্লাস", duration: 360, category: "ভার্সিটি", completed: false, icon: "🎓" },
                { time: "১:২৫ PM", task: "জোহরের নামাজ (ভার্সিটিতে)", duration: 20, category: "ধর্ম চর্চা", completed: false, icon: "🕌" },
                { time: "১:৪৫ PM", task: "দুপুরের খাবার (ভার্সিটিতে)", duration: 75, category: "স্বাস্থ্য", completed: false, icon: "🍽️" },
                { time: "৩:০০ PM", task: "ভার্সিটি ক্লাস", duration: 0, category: "ভার্সিটি", completed: true, icon: "🎓" },
                { time: "৫:১৫ PM", task: "আছরের নামাজ (ভার্সিটিতে)", duration: 15, category: "ধর্ম চর্চা", completed: false, icon: "🕌" },
                { time: "৫:৩০ PM", task: "ভার্সিটি থেকে ফেরা", duration: 75, category: "ব্যক্তিগত", completed: false, icon: "🚶‍♂️" }
            ],
            "বুধবার": [
                { time: "৬:৪৫ PM", task: "মাগরিবের নামাজ ও আমল", duration: 30, category: "ধর্ম চর্চা", completed: false, icon: "🕌" },
                { time: "৭:৩০ PM", task: "বই পড়া / একাডেমিক পড়া", duration: 60, category: "একাডেমিক", completed: false, icon: "📚" },
                { time: "৮:৩০ PM", task: "পরবর্তী দিনের পরিকল্পনা", duration: 15, category: "পরিকল্পনা", completed: false, icon: "📝" },
                { time: "৮:১৫ PM", task: "এশার নামাজ ও আমল (সূরা মুলক পাঠ)", duration: 30, category: "ধর্ম চর্চা", completed: false, icon: "🕌" },
                { time: "৮:৪৫ PM", task: "ব্যক্তিগত চিন্তা লেখা / হালকা কাজ", duration: 75, category: "ব্যক্তিগত", completed: false, icon: "✍️" },
                { time: "১০:০০ PM", task: "ঘুমের প্রস্তুতি (ডিভাইস বন্ধ)", duration: 30, category: "স্বাস্থ্য", completed: false, icon: "📵" },
                { time: "১০:৩০ PM", task: "ঘুম", duration: 360, category: "ঘুম", completed: false, icon: "😴" },
                { time: "৪:৩০ AM", task: "বিছানা গোছানো, ফ্রেশ হওয়া, ওজু", duration: 15, category: "ব্যক্তিগত", completed: false, icon: "💧" },
                { time: "৪:৪৫ AM", task: "ফজরের নামাজ ও আমল", duration: 30, category: "ধর্ম চর্চা", completed: false, icon: "🕌" },
                { time: "৫:১৫ AM", task: "পানি পান, ডেস্ক পরিষ্কার", duration: 15, category: "ব্যক্তিগত", completed: false, icon: "✨" },
                { time: "৫:৩০ AM", task: "ডিপ ওয়ার্ক (ওয়েব ডেভেলপমেন্ট)", duration: 210, category: "ওয়েব ডেভেলপমেন্ট", completed: false, icon: "💻" },
                { time: "৯:০০ AM", task: "ভার্সিটি ক্লাস", duration: 180, category: "ভার্সিটি", completed: false, icon: "🎓" },
                { time: "১২:০০ PM", task: "ঘর গোছানো, কাপড় ধোয়া", duration: 60, category: "ব্যক্তিগত", completed: false, icon: "🧹" },
                { time: "১:২৫ PM", task: "জোহরের নামাজ", duration: 20, category: "ধর্ম চর্চা", completed: false, icon: "🕌" },
                { time: "১:৪৫ PM", task: "দুপুরের খাবার ও বিশ্রাম", duration: 75, category: "স্বাস্থ্য", completed: false, icon: "🍽️" },
                { time: "৩:০০ PM", task: "ওয়েব ডেভেলপমেন্ট (অসম্পূর্ণ কাজ)", duration: 120, category: "ওয়েব ডেভেলপমেন্ট", completed: false, icon: "💻" },
                { time: "৫:১৫ PM", task: "আছরের নামাজ", duration: 15, category: "ধর্ম চর্চা", completed: false, icon: "🕌" },
                { time: "৫:৩০ PM", task: "হাঁটাচলা / খেলাধুলা", duration: 75, category: "স্বাস্থ্য", completed: false, icon: "🏃‍♂️" }
            ],
            "বৃহস্পতিবার": [
                { time: "৬:৪৫ PM", task: "মাগরিবের নামাজ ও আমল", duration: 30, category: "ধর্ম চর্চা", completed: false, icon: "🕌" },
                { time: "৭:৩০ PM", task: "টিউশনি (যাতায়াত সহ)", duration: 60, category: "কাজ", completed: false, icon: "🏫" },
                { time: "৮:৩০ PM", task: "পরবর্তী দিনের পরিকল্পনা", duration: 15, category: "পরিকল্পনা", completed: false, icon: "📝" },
                { time: "৮:১৫ PM", task: "এশার নামাজ ও আমল (সূরা মুলক পাঠ)", duration: 30, category: "ধর্ম চর্চা", completed: false, icon: "🕌" },
                { time: "৮:৪৫ PM", task: "ব্যক্তিগত চিন্তা লেখা / হালকা কাজ", duration: 75, category: "ব্যক্তিগত", completed: false, icon: "✍️" },
                { time: "১০:০০ PM", task: "ঘুমের প্রস্তুতি (ডিভাইস বন্ধ)", duration: 30, category: "স্বাস্থ্য", completed: false, icon: "📵" },
                { time: "১০:৩০ PM", task: "ঘুম", duration: 360, category: "ঘুম", completed: false, icon: "😴" },
                { time: "৪:৩০ AM", task: "বিছানা গোছানো, ফ্রেশ হওয়া, ওজু", duration: 15, category: "ব্যক্তিগত", completed: false, icon: "💧" },
                { time: "৪:৪৫ AM", task: "ফজরের নামাজ ও আমল", duration: 30, category: "ধর্ম চর্চা", completed: false, icon: "🕌" },
                { time: "৫:১৫ AM", task: "পানি পান, ডেস্ক পরিষ্কার", duration: 15, category: "ব্যক্তিগত", completed: false, icon: "✨" },
                { time: "৫:৩০ AM", task: "ডিপ ওয়ার্ক (ওয়েব ডেভেলপমেন্ট)", duration: 210, category: "ওয়েব ডেভেলপমেন্ট", completed: false, icon: "💻" },
                { time: "৯:০০ AM", task: "ডিপ ওয়ার্ক (ওয়েব ডেভেলপমেন্ট)", duration: 180, category: "ওয়েব ডেভেলপমেন্ট", completed: false, icon: "💻" },
                { time: "১২:০০ PM", task: "ভার্সিটি ক্লাস", duration: 180, category: "ভার্সিটি", completed: false, icon: "🎓" },
                { time: "১:২৫ PM", task: "জোহরের নামাজ (ভার্সিটিতে)", duration: 20, category: "ধর্ম চর্চা", completed: false, icon: "🕌" },
                { time: "১:৪৫ PM", task: "দুপুরের খাবার ও বিশ্রাম", duration: 75, category: "স্বাস্থ্য", completed: false, icon: "🍽️" },
                { time: "৩:০০ PM", task: "ML/DS/Algo/OOP শেখা", duration: 120, category: "অন্যান্য পড়া", completed: false, icon: "🧠" },
                { time: "৫:১৫ PM", task: "আছরের নামাজ", duration: 15, category: "ধর্ম চর্চা", completed: false, icon: "🕌" },
                { time: "৫:৩০ PM", task: "হাঁটাচলা / খেলাধুলা", duration: 75, category: "স্বাস্থ্য", completed: false, icon: "🏃‍♂️" }
            ],
            "শুক্রবার": [
                { time: "৬:৪৫ PM", task: "মাগরিবের নামাজ ও আমল", duration: 30, category: "ধর্ম চর্চা", completed: false, icon: "🕌" },
                { time: "৭:৩০ PM", task: "বই পড়া / একাডেমিক পড়া", duration: 60, category: "একাডেমিক", completed: false, icon: "📚" },
                { time: "৮:৩০ PM", task: "পরবর্তী দিনের পরিকল্পনা", duration: 15, category: "পরিকল্পনা", completed: false, icon: "📝" },
                { time: "৮:১৫ PM", task: "এশার নামাজ ও আমল (সূরা মুলক পাঠ)", duration: 30, category: "ধর্ম চর্চা", completed: false, icon: "🕌" },
                { time: "৮:৪৫ PM", task: "ব্যক্তিগত চিন্তা লেখা / পরিবারকে সময় দেওয়া", duration: 75, category: "ব্যক্তিগত", completed: false, icon: "👨‍👩‍👧‍👦" },
                { time: "১০:০০ PM", task: "ঘুমের প্রস্তুতি (ডিভাইস বন্ধ)", duration: 30, category: "স্বাস্থ্য", completed: false, icon: "📵" },
                { time: "১০:৩০ PM", task: "ঘুম", duration: 360, category: "ঘুম", completed: false, icon: "😴" },
                { time: "৪:৩০ AM", task: "বিছানা গোছানো, ফ্রেশ হওয়া, ওজু", duration: 15, category: "ব্যক্তিগত", completed: false, icon: "💧" },
                { time: "৪:৪৫ AM", task: "ফজরের নামাজ ও আমল", duration: 30, category: "ধর্ম চর্চা", completed: false, icon: "🕌" },
                { time: "৫:১৫ AM", task: " পানি পান, ডেস্ক পরিষ্কার", duration: 15, category: "ব্যক্তিগত", completed: false, icon: "✨" },
                { time: "৫:৩০ AM", task: "ডিপ ওয়ার্ক (ওয়েব ডেভেলপমেন্ট)", duration: 210, category: "ওয়েব ডেভেলপমেন্ট", completed: false, icon: "💻" },
                { time: "৯:০০ AM", task: "ডিপ ওয়ার্ক (ওয়েব ডেভেলপমেন্ট)", duration: 180, category: "ওয়েব ডেভেলপমেন্ট", completed: false, icon: "💻" },
                { time: "১২:০০ PM", task: "জুম্মার নামাজের প্রস্তুতি, সূরা কাহফ পাঠ", duration: 60, category: "ধর্ম চর্চা", completed: false, icon: "📖" },
                { time: "১:২৫ PM", task: "জুম্মার নামাজ", duration: 45, category: "ধর্ম চর্চা", completed: false, icon: "🕌" },
                { time: "২:১০ PM", task: "দুপুরের খাবার ও বিশ্রাম", duration: 75, category: "স্বাস্থ্য", completed: false, icon: "🍽️" },
                { time: "৩:৩০ PM", task: "ML/DS/Algo/OOP শেখা", duration: 90, category: "অন্যান্য পড়া", completed: false, icon: "🧠" },
                { time: "৫:১৫ PM", task: "আছরের নামাজ", duration: 15, category: "ধর্ম চর্চা", completed: false, icon: "🕌" },
                { time: "৫:৩০ PM", task: "হাঁটাচলা / খেলাধুলা", duration: 75, category: "স্বাস্থ্য", completed: false, icon: "🏃‍♂️" }
            ],
            "শনিবার": [
                { time: "৬:৪৫ PM", task: "মাগরিবের নামাজ ও আমল", duration: 30, category: "ধর্ম চর্চা", completed: false, icon: "🕌" },
                { time: "৭:৩০ PM", task: "সাপ্তাহিক পর্যালোচনা ও পরিকল্পনা", duration: 60, category: "পরিকল্পনা", completed: false, icon: "🗓️" },
                { time: "৮:৩০ PM", task: "পরবর্তী দিনের পরিকল্পনা", duration: 15, category: "পরিকল্পনা", completed: false, icon: "📝" },
                { time: "৮:১৫ PM", task: "এশার নামাজ ও আমল (সূরা মুলক পাঠ)", duration: 30, category: "ধর্ম চর্চা", completed: false, icon: "🕌" },
                { time: "৮:৪৫ PM", task: "ব্যক্তিগত চিন্তা লেখা / হালকা কাজ", duration: 75, category: "ব্যক্তিগত", completed: false, icon: "✍️" },
                { time: "১০:০০ PM", task: "ঘুমের প্রস্তুতি (ডিভাইস বন্ধ)", duration: 30, category: "স্বাস্থ্য", completed: false, icon: "📵" },
                { time: "১০:৩০ PM", task: "ঘুম", duration: 360, category: "ঘুম", completed: false, icon: "😴" },
                { time: "৪:৩০ AM", task: "বিছানা গোছানো, ফ্রেশ হওয়া, ওজু", duration: 15, category: "ব্যক্তিগত", completed: false, icon: "💧" },
                { time: "৪:৪৫ AM", task: "ফজরের নামাজ ও আমল", duration: 30, category: "ধর্ম চর্চা", completed: false, icon: "🕌" },
                { time: "৫:১৫ AM", task: "পানি পান, ডেস্ক পরিষ্কার", duration: 15, category: "ব্যক্তিগত", completed: false, icon: "✨" },
                { time: "৫:৩০ AM", task: "ডিপ ওয়ার্ক (ওয়েব ডেভেলপমেন্ট)", duration: 210, category: "ওয়েব ডেভেলপমেন্ট", completed: false, icon: "💻" },
                { time: "৯:০০ AM", task: "ডিপ ওয়ার্ক (ওয়েব ডেভেলপমেন্ট)", duration: 180, category: "ওয়েব ডেভেলপমেন্ট", completed: false, icon: "💻" },
                { time: "১২:০০ PM", task: "ঘর গোছানো, কাপড় ধোয়া", duration: 60, category: "ব্যক্তিগত", completed: false, icon: "🧹" },
                { time: "১:২৫ PM", task: "জোহরের নামাজ", duration: 20, category: "ধর্ম চর্চা", completed: false, icon: "🕌" },
                { time: "১:৪৫ PM", task: "দুপুরের খাবার ও বিশ্রাম", duration: 75, category: "স্বাস্থ্য", completed: false, icon: "🍽️" },
                { time: "৩:০০ PM", task: "ML/DS/Algo/OOP শেখা", duration: 120, category: "অন্যান্য পড়া", completed: false, icon: "🧠" },
                { time: "৫:১৫ PM", task: "আছরের নামাজ", duration: 15, category: "ধর্ম চর্চা", completed: false, icon: "🕌" },
                { time: "৫:৩০ PM", task: "হাঁটাচলা / খেলাধুলা", duration: 75, category: "স্বাস্থ্য", completed: false, icon: "🏃‍♂️" }
            ],
        };
        
        const dayOrder = ["শনিবার", "রবিবার", "সোমবার", "মঙ্গলবার", "বুধবার", "বৃহস্পতিবার", "শুক্রবার"];
        const dayMapping = { 0: "রবিবার", 1: "সোমবার", 2: "মঙ্গলবার", 3: "বুধবার", 4: "বৃহস্পতিবার", 5: "শুক্রবার", 6: "শনিবার" };

        let selectedDay;
        let dailyChart, weeklyChart, timeAllocationChart;

        // Get modal elements
        const modal = document.getElementById('detailedPlanModal');
        const closeModalBtn = document.getElementsByClassName('close-button')[0];
        const modalTitle = document.getElementById('modal-title');
        const modalContentArea = document.getElementById('modal-content-area');
        const modalLoadingIndicator = document.getElementById('modal-loading-indicator');

        document.addEventListener('DOMContentLoaded', () => {
            const today = new Date();
            selectedDay = dayMapping[today.getDay()];
            
            const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            document.getElementById('currentDate').textContent = today.toLocaleDateString('bn-BD', options);

            initDaySelector();
            renderTasks(selectedDay);
            initCharts();
            updateAllCharts(selectedDay);

            document.getElementById('smart-plan-btn').addEventListener('click', generateSmartPlan);
            document.getElementById('motivation-btn').addEventListener('click', generateMotivationQuote);
            document.getElementById('reflection-btn').addEventListener('click', generateReflectionPrompt);
            document.getElementById('islamic-knowledge-btn').addEventListener('click', generateIslamicKnowledge);

            // Close modal events
            closeModalBtn.onclick = function() {
                modal.style.display = "none";
            }
            window.onclick = function(event) {
                if (event.target == modal) {
                    modal.style.display = "none";
                }
            }
        });

        function initDaySelector() {
            const selector = document.getElementById('day-selector');
            dayOrder.forEach(day => {
                const button = document.createElement('button');
                button.textContent = day;
                button.className = 'day-btn p-2 rounded-lg font-semibold bg-white shadow';
                if (day === selectedDay) {
                    button.classList.add('active');
                }
                button.addEventListener('click', () => {
                    selectedDay = day;
                    document.querySelectorAll('.day-btn').forEach(btn => btn.classList.remove('active'));
                    button.classList.add('active');
                    renderTasks(day);
                    updateAllCharts(day);
                    document.getElementById('llm-suggestion-area').classList.add('hidden'); // Hide smart plan suggestion when changing day
                    document.getElementById('motivation-area').classList.add('hidden'); // Hide motivation when changing day
                    document.getElementById('reflection-area').classList.add('hidden'); // Hide reflection when changing day
                    document.getElementById('islamic-knowledge-area').classList.add('hidden'); // Hide Islamic knowledge when changing day
                });
                selector.appendChild(button);
            });
        }
        
        function renderTasks(day) {
            const taskList = document.getElementById('task-list');
            taskList.innerHTML = '';
            document.getElementById('selected-day-title').textContent = `${day} এর কাজ`;
            
            const tasks = scheduleData[day];
            if (!tasks) return;

            tasks.forEach((task, index) => {
                if (task.duration === 0) return;

                const card = document.createElement('div');
                card.className = `task-card flex items-center p-3 rounded-lg bg-gray-50 border-primary`;
                if (task.completed) card.classList.add('completed');
                
                card.innerHTML = `
                    <div class="mr-3 text-2xl">${task.icon}</div>
                    <div class="flex-grow">
                        <p class="font-bold task-text">${task.task}</p>
                        <p class="text-sm text-gray-500">${task.time}</p>
                    </div>
                    <div class="flex items-center space-x-2">
                        <button class="px-3 py-1 bg-secondary text-white rounded-md text-xs hover:bg-yellow-600 transition duration-300" 
                                data-task-name="${task.task}" 
                                data-task-category="${task.category}"
                                data-task-time="${task.time}"
                                data-task-duration="${task.duration}">
                            বিস্তারিত পরিকল্পনা ✨
                        </button>
                        <input type="checkbox" class="form-checkbox h-6 w-6 text-primary rounded focus:ring-0" ${task.completed ? 'checked' : ''}>
                    </div>
                `;
                
                card.querySelector('input[type="checkbox"]').addEventListener('change', (e) => {
                    task.completed = e.target.checked;
                    card.classList.toggle('completed', task.completed);
                    updateAllCharts(day);
                });

                card.querySelector('button').addEventListener('click', (e) => {
                    const taskName = e.target.dataset.taskName;
                    const taskCategory = e.target.dataset.taskCategory;
                    const taskTime = e.target.dataset.taskTime;
                    const taskDuration = e.target.dataset.taskDuration;
                    showDetailedPlanModal(taskName, taskCategory, taskTime, taskDuration);
                });

                taskList.appendChild(card);
            });
        }
        
        function updateAllCharts(day) {
            updateDailyProgressChart(day);
            updateWeeklyProgressChart();
            updateTimeAllocationChart(day);
        }

        function initCharts() {
            const dailyCtx = document.getElementById('dailyProgressChart').getContext('2d');
            dailyChart = new Chart(dailyCtx, {
                type: 'doughnut',
                data: { labels: ['সম্পন্ন', 'বাকি'], datasets: [{ data: [0, 100], backgroundColor: ['#008080', '#e0e0e0'], borderWidth: 0 }] },
                options: { responsive: true, maintainAspectRatio: false, cutout: '70%', plugins: { legend: { display: false } } }
            });

            const weeklyCtx = document.getElementById('weeklyProgressChart').getContext('2d');
            weeklyChart = new Chart(weeklyCtx, {
                type: 'bar',
                data: { labels: dayOrder, datasets: [{ label: 'সাপ্তাহিক অগ্রগতি (%)', data: [], backgroundColor: '#e6c584' }] },
                options: { responsive: true, maintainAspectRatio: false, scales: { y: { beginAtZero: true, max: 100 } }, plugins: { legend: { display: false } } }
            });
            
            const timeCtx = document.getElementById('timeAllocationChart').getContext('2d');
            timeAllocationChart = new Chart(timeCtx, {
                type: 'pie',
                data: { labels: [], datasets: [{ data: [], backgroundColor: ['#008080', '#f4a261', '#e6c584', '#2a9d8f', '#264653', '#e76f51', '#e9c46a'] }] },
                options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { position: 'bottom' } } }
            });
        }
        
        function updateDailyProgressChart(day) {
            const tasks = scheduleData[day];
            const totalTasks = tasks.filter(t => t.duration > 0).length;
            const completedTasks = tasks.filter(t => t.completed && t.duration > 0).length;
            const percentage = totalTasks > 0 ? (completedTasks / totalTasks) * 100 : 0;
            
            dailyChart.data.datasets[0].data = [percentage, 100 - percentage];
            dailyChart.update();
            
            document.getElementById('daily-summary-text').textContent = `আজ ${completedTasks}/${totalTasks} টি কাজ সম্পন্ন হয়েছে।`;
        }
        
        function updateWeeklyProgressChart() {
            const weeklyData = dayOrder.map(day => {
                const tasks = scheduleData[day];
                const totalTasks = tasks.filter(t => t.duration > 0).length;
                const completedTasks = tasks.filter(t => t.completed && t.duration > 0).length;
                return totalTasks > 0 ? (completedTasks / totalTasks) * 100 : 0;
            });
            weeklyChart.data.datasets[0].data = weeklyData;
            weeklyChart.update();
        }

        function updateTimeAllocationChart(day) {
            const tasks = scheduleData[day];
            const allocation = {};
            
            tasks.forEach(task => {
                if (task.duration > 0) {
                    if (!allocation[task.category]) {
                        allocation[task.category] = 0;
                    }
                    allocation[task.category] += task.duration;
                }
            });
            
            const labels = Object.keys(allocation);
            const data = Object.values(allocation);
            
            timeAllocationChart.data.labels = labels;
            timeAllocationChart.data.datasets[0].data = data;
            timeAllocationChart.update();
        }

        async function generateSmartPlan() {
            const suggestionArea = document.getElementById('llm-suggestion-area');
            const suggestionContent = document.getElementById('llm-suggestion-content');
            const loadingIndicator = document.getElementById('llm-loading-indicator');

            suggestionArea.classList.remove('hidden');
            suggestionContent.innerHTML = '';
            loadingIndicator.classList.remove('hidden');
            document.getElementById('motivation-area').classList.add('hidden'); // Hide other areas
            document.getElementById('reflection-area').classList.add('hidden');
            document.getElementById('islamic-knowledge-area').classList.add('hidden');

            const currentTasks = scheduleData[selectedDay];
            let taskListString = currentTasks.map(task => `${task.time}: ${task.task} (${task.category}, ${task.duration} মিনিট)`).join('\n');

            const prompt = `আপনি একজন অভিজ্ঞ রুটিন পরিকল্পনাকারী। একজন মুসলিম শিক্ষার্থীর জন্য একটি দৈনিক রুটিন অপ্টিমাইজ করতে সাহায্য করুন। তার দিনের প্রধান অংশগুলো ধর্মচর্চা, ওয়েব ডেভেলপমেন্ট (ডিপ ওয়ার্ক), ভার্সিটি ক্লাস, টিউশনি, এবং ব্যক্তিগত স্বাস্থ্য। নিম্নলিখিত কাজগুলো এই দিনের জন্য নির্ধারিত:\n${taskListString}\n\nএই কাজগুলোর উপর ভিত্তি করে, একটি স্মার্ট পরিকল্পনা তৈরি করুন। আপনার পরিকল্পনায় কাজের অগ্রাধিকার, সম্ভাব্য সময় সমন্বয়, এবং ফোকাস বজায় রাখার জন্য পরামর্শ থাকতে পারে। শুধুমাত্র বাংলাতে উত্তর দিন।`;

            let chatHistory = [];
            chatHistory.push({ role: "user", parts: [{ text: prompt }] });
            const payload = { contents: chatHistory };
            const apiKey = "AIzaSyCQYt3BVMdvL4yTCzmB-61oYLuC2WgMLsA"; // <-- এখানে আপনার জেমিনি এপিআই কী দিন
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;

            try {
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });
                const result = await response.json();
                if (result.candidates && result.candidates.length > 0 &&
                    result.candidates[0].content && result.candidates[0].content.parts &&
                    result.candidates[0].content.parts.length > 0) {
                    const text = result.candidates[0].content.parts[0].text;
                    suggestionContent.innerHTML = text.replace(/\n/g, '<br>');
                } else {
                    suggestionContent.textContent = 'পরামর্শ তৈরি করা যায়নি। অনুগ্রহ করে আবার চেষ্টা করুন।';
                }
            } catch (error) {
                console.error('Error calling Gemini API:', error);
                suggestionContent.textContent = 'পরামর্শ তৈরি করার সময় একটি ত্রুটি হয়েছে।';
            } finally {
                loadingIndicator.classList.add('hidden');
            }
        }

        async function generateMotivationQuote() {
            const motivationArea = document.getElementById('motivation-area');
            const motivationContent = document.getElementById('motivation-content');
            const loadingIndicator = document.getElementById('motivation-loading-indicator');

            motivationArea.classList.remove('hidden');
            motivationContent.innerHTML = '';
            loadingIndicator.classList.remove('hidden');
            document.getElementById('llm-suggestion-area').classList.add('hidden'); // Hide other areas
            document.getElementById('reflection-area').classList.add('hidden');
            document.getElementById('islamic-knowledge-area').classList.add('hidden');

            const prompt = `একজন মুসলিম শিক্ষার্থীর জন্য দৈনন্দিন রুটিন মেনে চলার জন্য একটি সংক্ষিপ্ত অনুপ্রেরণামূলক উক্তি বা ইসলামিক স্মরণিকা তৈরি করুন। এটি তাকে তার ধর্মচর্চা, পড়াশোনা, এবং ব্যক্তিগত উন্নতিতে ফোকাস বজায় রাখতে সাহায্য করবে। শুধুমাত্র বাংলাতে উত্তর দিন।`;

            let chatHistory = [];
            chatHistory.push({ role: "user", parts: [{ text: prompt }] });
            const payload = { contents: chatHistory };
            const apiKey = "AIzaSyCQYt3BVMdvL4yTCzmB-61oYLuC2WgMLsA"; // <-- এখানে আপনার জেমিনি এপিআই কী দিন
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;

            try {
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });
                const result = await response.json();
                if (result.candidates && result.candidates.length > 0 &&
                    result.candidates[0].content && result.candidates[0].content.parts &&
                    result.candidates[0].content.parts.length > 0) {
                    const text = result.candidates[0].content.parts[0].text;
                    motivationContent.innerHTML = text.replace(/\n/g, '<br>');
                } else {
                    motivationContent.textContent = 'অনুপ্রেরণা বার্তা তৈরি করা যায়নি। অনুগ্রহ করে আবার চেষ্টা করুন।';
                }
            } catch (error) {
                console.error('Error calling Gemini API:', error);
                motivationContent.textContent = 'অনুপ্রেরণা বার্তা তৈরি করার সময় একটি ত্রুটি হয়েছে।';
            } finally {
                loadingIndicator.classList.add('hidden');
            }
        }

        async function generateReflectionPrompt() {
            const reflectionArea = document.getElementById('reflection-area');
            const reflectionContent = document.getElementById('reflection-content');
            const loadingIndicator = document.getElementById('reflection-loading-indicator');

            reflectionArea.classList.remove('hidden');
            reflectionContent.innerHTML = '';
            loadingIndicator.classList.remove('hidden');
            document.getElementById('llm-suggestion-area').classList.add('hidden'); // Hide other areas
            document.getElementById('motivation-area').classList.add('hidden');
            document.getElementById('islamic-knowledge-area').classList.add('hidden');

            const currentTasks = scheduleData[selectedDay];
            let taskListString = currentTasks.map(task => `${task.time}: ${task.task} (${task.category})`).join('\n');

            const prompt = `একজন মুসলিম শিক্ষার্থীর জন্য তার দৈনন্দিন রুটিন এবং ধর্মীয় মূল্যবোধের উপর ভিত্তি করে একটি সংক্ষিপ্ত আত্ম-পর্যালোচনার প্রশ্ন বা জার্নাল প্রম্পট তৈরি করুন। তার আজকের দিনের কিছু কাজ হল:\n${taskListString}\n\nএই কাজগুলোর আলোকে তার ব্যক্তিগত বৃদ্ধি এবং আধ্যাত্মিক উন্নতির জন্য একটি প্রশ্ন তৈরি করুন। শুধুমাত্র বাংলাতে উত্তর দিন।`;

            let chatHistory = [];
            chatHistory.push({ role: "user", parts: [{ text: prompt }] });
            const payload = { contents: chatHistory };
            const apiKey = "AIzaSyCQYt3BVMdvL4yTCzmB-61oYLuC2WgMLsA"; // <-- এখানে আপনার জেমিনি এপিআই কী দিন
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;

            try {
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });
                const result = await response.json();
                if (result.candidates && result.candidates.length > 0 &&
                    result.candidates[0].content && result.candidates[0].content.parts &&
                    result.candidates[0].content.parts.length > 0) {
                    const text = result.candidates[0].content.parts[0].text;
                    reflectionContent.innerHTML = text.replace(/\n/g, '<br>');
                } else {
                    reflectionContent.textContent = 'আত্ম-পর্যালোচনার প্রশ্ন তৈরি করা যায়নি। অনুগ্রহ করে আবার চেষ্টা করুন।';
                }
            } catch (error) {
                console.error('Error calling Gemini API:', error);
                reflectionContent.textContent = 'আত্ম-পর্যালোচনার প্রশ্ন তৈরি করার সময় একটি ত্রুটি হয়েছে।';
            } finally {
                loadingIndicator.classList.add('hidden');
            }
        }

        async function generateIslamicKnowledge() {
            const islamicKnowledgeArea = document.getElementById('islamic-knowledge-area');
            const islamicKnowledgeContent = document.getElementById('islamic-knowledge-content');
            const loadingIndicator = document.getElementById('islamic-knowledge-loading-indicator');

            islamicKnowledgeArea.classList.remove('hidden');
            islamicKnowledgeContent.innerHTML = '';
            loadingIndicator.classList.remove('hidden');
            document.getElementById('llm-suggestion-area').classList.add('hidden'); // Hide other areas
            document.getElementById('motivation-area').classList.add('hidden');
            document.getElementById('reflection-area').classList.add('hidden');

            const prompt = `একজন মুসলিম শিক্ষার্থীর জন্য দৈনন্দিন জীবন বা তার রুটিনের সাথে প্রাসঙ্গিক একটি সংক্ষিপ্ত ইসলামিক জ্ঞান, হাদিস বা কুরআনের আয়াত এবং এর সংক্ষিপ্ত ব্যাখ্যা তৈরি করুন। এটি তাকে তার ধর্মীয় জ্ঞান বৃদ্ধি করতে এবং আল্লাহর সাথে সম্পর্ক সুদৃঢ় করতে সাহায্য করবে। শুধুমাত্র বাংলাতে উত্তর দিন।`;

            let chatHistory = [];
            chatHistory.push({ role: "user", parts: [{ text: prompt }] });
            const payload = { contents: chatHistory };
            const apiKey = "AIzaSyCQYt3BVMdvL4yTCzmB-61oYLuC2WgMLsA"; // <-- এখানে আপনার জেমিনি এপিআই কী দিন
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;

            try {
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });
                const result = await response.json();
                if (result.candidates && result.candidates.length > 0 &&
                    result.candidates[0].content && result.candidates[0].content.parts &&
                    result.candidates[0].content.parts.length > 0) {
                    const text = result.candidates[0].content.parts[0].text;
                    islamicKnowledgeContent.innerHTML = text.replace(/\n/g, '<br>');
                } else {
                    islamicKnowledgeContent.textContent = 'ইসলামিক জ্ঞান তৈরি করা যায়নি। অনুগ্রহ করে আবার চেষ্টা করুন।';
                }
            } catch (error) {
                console.error('Error calling Gemini API:', error);
                islamicKnowledgeContent.textContent = 'ইসলামিক জ্ঞান তৈরি করার সময় একটি ত্রুটি হয়েছে।';
            } finally {
                loadingIndicator.classList.add('hidden');
            }
        }

        async function showDetailedPlanModal(taskName, taskCategory, taskTime, taskDuration) {
            modal.style.display = "flex"; // Show the modal
            modalTitle.textContent = `${taskName} - বিস্তারিত পরিকল্পনা`;
            modalContentArea.innerHTML = '';
            modalLoadingIndicator.classList.remove('hidden');

            let prompt = `আপনি একজন অভিজ্ঞ পরামর্শদাতা। একজন মুসলিম শিক্ষার্থীর জন্য "${taskName}" কাজটি (${taskCategory} ক্যাটাগরির, ${taskTime} সময়ে, ${taskDuration} মিনিট) কিভাবে আরও কার্যকরভাবে সম্পন্ন করা যায় তার একটি বিস্তারিত পরিকল্পনা বা পরামর্শ দিন। এই কাজটি তার দৈনন্দিন রুটিনের অংশ।`;

            if (taskCategory === "ওয়েব ডেভেলপমেন্ট") {
                prompt += ` এই কাজটি তার জন্য খুবই গুরুত্বপূর্ণ এবং এর মধ্যে ভিডিও দেখা, প্র্যাকটিস করা এবং রিসোর্স ঘাঁটাঘাঁটি করা অন্তর্ভুক্ত। কিভাবে এই তিনটি অংশকে কার্যকরভাবে সম্পন্ন করা যায় তার বিস্তারিত ধাপ এবং টিপস দিন।`;
            } else if (taskCategory === "ধর্ম চর্চা") {
                prompt += ` ধর্মীয় কাজ হিসেবে, কিভাবে আরও মনোযোগ সহকারে এবং আধ্যাত্মিকভাবে এই কাজটি করা যায় তার টিপস দিন।`;
            } else if (taskCategory === "অন্যান্য পড়া") { // ML/DS/Algo/OOP
                prompt += ` এই কাজটি তার ভবিষ্যৎ শেখার পথের অংশ। কিভাবে এই নির্দিষ্ট বিষয় (যেমন: ${taskName.split(' ')[0]}) কার্যকরভাবে শেখা যায় তার একটি সংক্ষিপ্ত রোডম্যাপ বা টিপস দিন।`;
            } else if (taskCategory === "স্বাস্থ্য") {
                prompt += ` এই কাজটি তার স্বাস্থ্যের সাথে সম্পর্কিত। কিভাবে এই কাজটি তার স্বাস্থ্যকে আরও উন্নত করতে সাহায্য করবে এবং এটিকে আরও কার্যকর করার জন্য কোনো অতিরিক্ত টিপস আছে কিনা, তা উল্লেখ করুন।`;
            } else if (taskCategory === "কাজ") { // টিউশনি
                prompt += ` এই কাজটি তার আয়ের উৎস। কিভাবে এই কাজটি আরও দক্ষতার সাথে করা যায় এবং এর পাশাপাশি নিজের পড়াশোনার সময় বের করা যায় তার টিপস দিন।`;
            } else if (taskCategory === "ভার্সিটি") {
                prompt += ` ভার্সিটির ক্লাস বা কাজ হিসেবে, কিভাবে এটি থেকে সর্বোচ্চ সুবিধা নেওয়া যায় এবং অন্যান্য কাজগুলোর সাথে এর ভারসাম্য বজায় রাখা যায় তার টিপস দিন।`;
            } else if (taskCategory === "পরিকল্পনা") {
                prompt += ` এই কাজটি তার রুটিনকে সুসংগঠিত রাখতে সাহায্য করে। কিভাবে আরও কার্যকরভাবে পরিকল্পনা করা যায় এবং সেই পরিকল্পনাকে মেনে চলা যায় তার টিপস দিন।`;
            } else if (taskCategory === "ব্যক্তিগত") {
                prompt += ` এই কাজটি তার ব্যক্তিগত উন্নয়নের অংশ। কিভাবে এই কাজটি তার মানসিক শান্তি বা উৎপাদনশীলতা বাড়াতে সাহায্য করবে এবং এটিকে আরও ফলপ্রসূ করার জন্য কোনো অতিরিক্ত টিপস আছে কিনা, তা উল্লেখ করুন।`;
            } else if (taskCategory === "ঘুম") {
                prompt += ` এই কাজটি তার স্বাস্থ্যের জন্য অত্যন্ত গুরুত্বপূর্ণ। কিভাবে ঘুমের মান উন্নত করা যায় এবং পর্যাপ্ত ঘুম নিশ্চিত করা যায় তার টিপস দিন।`;
            }
            prompt += ` শুধুমাত্র বাংলাতে উত্তর দিন।`;


            let chatHistory = [];
            chatHistory.push({ role: "user", parts: [{ text: prompt }] });
            const payload = { contents: chatHistory };
            const apiKey = "AIzaSyCQYt3BVMdvL4yTCzmB-61oYLuC2WgMLsA"; // <-- এখানে আপনার জেমিনি এপিআই কী দিন
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;

            try {
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });
                const result = await response.json();
                if (result.candidates && result.candidates.length > 0 &&
                    result.candidates[0].content && result.candidates[0].content.parts &&
                    result.candidates[0].content.parts.length > 0) {
                    const text = result.candidates[0].content.parts[0].text;
                    modalContentArea.innerHTML = text.replace(/\n/g, '<br>');
                } else {
                    modalContentArea.textContent = 'বিস্তারিত পরিকল্পনা তৈরি করা যায়নি। অনুগ্রহ করে আবার চেষ্টা করুন।';
                }
            } catch (error) {
                console.error('Error calling Gemini API:', error);
                modalContentArea.textContent = 'বিস্তারিত পরিকল্পনা তৈরি করার সময় একটি ত্রুটি হয়েছে।';
            } finally {
                modalLoadingIndicator.classList.add('hidden');
            }
        }

    </script>
</body>
</html>